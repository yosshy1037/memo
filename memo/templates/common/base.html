<!DOCTYPE html>
<html>
<head lang="ja">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>メモ管理システム-検索画面</title>
  {% load static %}
  <link href="{% static "css/bootstrap.min.css" %}" rel="stylesheet">
  <link href="{% static 'css/main.css' %}" rel="stylesheet">
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
  <script src="{% static "js/bootstrap.min.js" %}"></script>
  <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>-->
  <script src="{% static "js/jquery.min.js" %}"></script>
<script>
// using jQuery
function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie != '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = jQuery.trim(cookies[i]);
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) == (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
var csrftoken = getCookie('csrftoken');

function csrfSafeMethod(method) {
    // these HTTP methods do not require CSRF protection
    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
}
$.ajaxSetup({
    crossDomain: false, // obviates need for sameOrigin test
    beforeSend: function(xhr, settings) {
        if (!csrfSafeMethod(settings.type)) {
            xhr.setRequestHeader("X-CSRFToken", csrftoken);
        }
    }
});
$(document).ready( function(){
  var part = "{{ part }}";
  var name = "{{ name }}";
  var pageNumber = "{{ pageNum }}";
  if(pageNumber == ""){
      pageNumber = 0;
  }
  pager(pageNumber,part,name);
});

function pager(pageNum,part,name){
    if(pageNum == 0){
      pageNum = 1;
    }
    $('input:hidden[name="pageNum"]').val(pageNum);
    $.ajax({
      'url':'/memo/dataList/',
      'type':'POST',
      'data':{
        'pageNum':pageNum,
        'partVal':part,
        'nameVal':name,
      },
      'dataType':'json',
      'success':function(response){
        $("#atag").html(response.atag);
        $("#resultErea").html(response.result);
      },
      'error':function(XMLHttpRequest, textStatus, errorThrown){
        alert("XMLHttpRequest : " + XMLHttpRequest.status + "/" + "errorThrown    : " + errorThrown.message );
      },
    });
    return false;
}
</script>
</head>
<body>
{% block body %}
{% endblock %}
</body>
</html>